const { Client, AccountId, PrivateKey, ContractCreateFlow, Hbar } = require('@hashgraph/sdk');
const fs = require('fs');
require('dotenv').config();

async function deploySkillSwap() {
    try {
        console.log('üéØ SkillSwap Contract Deployment');
        console.log('================================\n');
        
        // Get credentials from environment
        const accountId = process.env.HEDERA_TESTNET_ACCOUNT_ID;
        const privateKeyDer = process.env.HEDERA_TESTNET_PRIVATE_KEY;
        
        if (!accountId || !privateKeyDer) {
            throw new Error('Please set HEDERA_TESTNET_ACCOUNT_ID and HEDERA_TESTNET_PRIVATE_KEY in your .env file');
        }
        
        console.log(`üìã Account ID: ${accountId}`);
        console.log(`üîë Private Key: ${privateKeyDer.substring(0, 20)}...`);
        
        // Create client and set operator
        const client = Client.forTestnet();
        const operatorId = AccountId.fromString(accountId);
        
        // Use DER encoded private key
        const operatorKey = PrivateKey.fromStringDer(privateKeyDer);
        
        client.setOperator(operatorId, operatorKey);
        
        // Set higher transaction fee
        client.setMaxTransactionFee(new Hbar(50));
        
        console.log('‚úÖ Client configured successfully');
        
        // Real compiled bytecode from Foundry
        const contractBytecode = '0x608060405234801561001057600080fd5b50600380546001600160a01b0319163317905561317b806100326000396000f3fe608060405234801561001057600080fd5b50600436106101a95760003560e01c80636352211e116100f95780639afc09ac11610097578063bbd94c2f11610071578063bbd94c2f1461042e578063c2787cb514610457578063eb18a9d814610477578063fbf30c351461048a57600080fd5b80639afc09ac146103d2578063a7336b64146103e5578063a87430ba1461040b57600080fd5b806378ef1138116100d357806378ef113814610386578063844bf6c11461039957806386cfa7d3146103ac5780638da5cb5b146103bf57600080fd5b80636352211e146103125780636f77926b1461033d57806370a082311461035d57600080fd5b8063291c73c31161016657806335d122031161014057806335d12203146102915780634f558e79146102a457806352de4ee5146102df5780635aef573c146102ff57600080fd5b8063291c73c3146102405780632aa41ed0146102535780632ccd7b2f1461027e57600080fd5b80630e33599d146101ae57806311f2e10d146101c35780631a5007dd146101d65780631b31527f146101ed578063260903491461020057806327e235e314610220575b600080fd5b6101c16101bc366004612753565b610492565b005b6101c16101d136600461277f565b6106d2565b6001545b6040519081526020015b60405180910390f35b6101da6101fb366004612798565b610a1b565b61021361020e36600461277f565b610a4c565b6040516101e49190612808565b6101da61022e3660046128a0565b600b6020526000908152604090205481565b6101da61024e366004612798565b610ca7565b61026661026136600461277f565b610cc3565b6040516101e49c9b9a999897969594939291906128fa565b6101c161028c36600461277f565b610e56565b6101c161029f366004612af3565b610fcf565b6102cf6102b236600461277f565b6000908152600a60205260409020546001600160a01b0316151590565b60405190151581526020016101e4565b6102f26102ed3660046128a0565b6111bf565b6040516101e49190612b7b565b6101c161030d366004612bbf565b61122b565b61032561032036600461277f565b6115e7565b6040516001600160a01b0390911681526020016101e4565b61035061034b3660046128a0565b61165e565b6040516101e49190612c5b565b6101da61036b3660046128a0565b6001600160a01b031660009081526009602052604090205490565b6102f26103943660046128a0565b611929565b6101c16103a7366004612bbf565b611993565b6101da6103ba366004612798565b611cdc565b600354610325906001600160a01b031681565b6101c16103e0366004612ce0565b611cf8565b6103f86103f336600461277f565b611f1c565b6040516101e49796959493929190612d5e565b61041e6104193660046128a0565b6120fd565b6040516101e49493929190612dc5565b61032561043c36600461277f565b600a602052600090815260409020546001600160a01b031681565b61046a61046536600461277f565b6121b3565b6040516101e49190612df4565b6102f26104853660046128a0565b612421565b6000546101da565b6003546001600160a01b031633146104e15760405162461bcd60e51b815260206004820152600d60248201526c2737ba103a34329037bbb732b960991b60448201526064015b60405180910390fd5b6000828152600660205260409020600460058083015460ff169081111561050a5761050a6128c2565b1461054f5760405162461bcd60e51b81526020600482015260156024820152744e6f206469737075746520746f207265736f6c766560581b60448201526064016104d8565b60028101546001600160a01b038381169116148061057c575060038101546001600160a01b038381169116145b6105b95760405162461bcd60e51b815260206004820152600e60248201526d24b73b30b634b2103bb4b73732b960911b60448201526064016104d8565b60028101546000906001600160a01b038481169116146105e65760028201546001600160a01b03166105f5565b60038201546001600160a01b03165b6001600160a01b03841660009081526004602052604081206003018054929350600a92909190610626908490612f05565b90915550506001600160a01b038116600090815260046020526040902060030154600a1015610681576001600160a01b03811660009081526004602052604081206003018054600a929061067b908490612f1e565b90915550505b60058201805460ff191660031790554260078301556040516001600160a01b0384169085907ff77ceb5e091d2da041bc760667f9d5fe7a756949eaf29250ad0e60ca6f4c27d990600090a350505050565b60008181526006602090815260408083208151610180810183528154815260018201549381019390935260028101546001600160a01b0390811692840192909252600381015490911660608301526004810180548594939291608084019161073990612f31565b80601f016020809104026020016040519081016040528092919081815260200182805461076590612f31565b80156107b25780601f10610787576101008083540402835291602001916107b2565b820191906000526020600020905b81548152906001019060200180831161079557829003601f168201915b505050918352505060058281015460209092019160ff16908111156107d9576107d96128c2565b60058111156107ea576107ea6128c2565b81526006820154602082015260078201546040820152600882015460ff80821615156060840152610100820416151560808301526201000090046001600160a01b031660a082015260098201805460c09092019161084790612f31565b80601f016020809104026020016040519081016040528092919081815260200182805461087390612f31565b80156108c05780601f10610895576101008083540402835291602001916108c0565b820191906000526020600020905b8154815290600101906020018083116108a357829003601f168201915b5050505050815250509050336001600160a01b031681604001516001600160a01b031614806108fb575060608101516001600160a01b031633145b6109425760405162461bcd60e51b8152602060048201526018602482015277139bdd081c1c9bdc1bdcd85b081c185c9d1a58da5c185b9d60421b60448201526064016104d8565b6000838152600660205260409020600160058083015460ff169081111561096b5761096b6128c2565b146109b05760405162461bcd60e51b8152602060048201526015602482015274141c9bdc1bdcd85b081b9bdd081858d8d95c1d1959605a1b60448201526064016104d8565b60028101546001600160a01b031633036109d85760088101805460ff191660011790556109ea565b60088101805461ff0019166101001790555b600881015460ff168015610a0757506008810154610100900460ff165b15610a1557610a158461248b565b50505050565b60086020528160005260406000208181548110610a3757600080fd5b90600052602060002001600091509150505481565b610a976040518060e001604052806000815260200160006001600160a01b03168152602001606081526020016060815260200160608152602001600015158152602001600081525090565b600082815260056020908152604091829020825160e0810184528154815260018201546001600160a01b0316928101929092526002810180549293919291840191610ae190612f31565b80601f0160208091040260200160405190810160405280929190818152602001828054610b0d90612f31565b8015610b5a5780601f10610b2f57610100808354040283529160200191610b5a565b820191906000526020600020905b815481529060010190602001808311610b3d5782900361f168201915b50505050508152602001600382018054610b7390612f31565b80601f0160208091040260200160405190810160405280929190818152602001828054610b9f90612f31565b8015610bec5780601f10610bc157610100808354040283529160200191610bec565b820191906000526020600020905b815481529060010190602001808311610bcf5782900361f168201915b50505050508152602001600482018054610c0590612f31565b80601f0160208091040260200160405190810160405280929190818152602001828054610c3190612f31565b8015610c7e5780601f10610c5357610100808354040283529160200191610c7e565b820191906000526020600020905b815481529060010190602001808311610c6157829003601f168201915b5050509183525050600582015460ff161515602082015260069091015460409091015292915050565b60096020528160005260406000208181548110610a3757600080fd5b60066020526000908152604090208054600182015460028301546003840154600485018054949593946001600160a01b03938416949290931692610d0690612f31565b80601f0160208091040260200160405190810160405280929190818152602001828054610d3290612f31565b8015610d7f5780601f10610d5457610100808354040283529160200191610d7f565b820191906000526020600020905b815481529060010190602001808311610d6257829003601f168201915b5050506005840154600685015460078601546008870154600988018054979860ff9586169894975092955081851694610100830416936001600160a01b0362010000909304929092169291610dd390612f31565b80601f0160208091040260200160405190810160405280929190818152602001828054610dff90612f31565b8015610e4c5780601f10610e2157610100808354040283529160200191610e4c565b820191906000526020600020905b815481529060010190602001808311610e2f5782900361f168201915b505050505090508c565b336000908152600460208190526040909120015460ff16610e895760405162461bcd60e51b81526004016104d890612f6b565b60008181526006602052604081209060058083015460ff1690811115610eb157610eb16128c2565b14610ef55760405162461bcd60e51b815260206004820152601460248201527350726f706f73616c206e6f742070656e64696e6760601b60448201526064016104d8565b600180820154600090815260056020526040902001546001600160a01b03163314610f565760405162461bcd60e51b81526020600482015260116024820152702737ba103634b9ba34b7339037bbb732b960791b60448201526064016104d8565b6003810180546001600160a01b031916331790556005810180546001919060ff19168280021790555033600081815260086020908152604080832080546001810182559084529183209091018590555184917f0bd5ceab5d3b7c6cf8c3bac45aae59a3596d79b1789503709720d231fe519bff91a35050565b336000908152600460208190526040909120015460ff16156110335760405162461bcd60e51b815260206004820152601760248201527f5573657220616c7265616479207265676973746572656400000000000000000060448201526064016104d8565b600083511161107b5760405162461bcd60e51b81526020600482015260146024820152734e616d652063616e6e6f7420626520656d70747960601b60448201526064016104d8565b60008251116110cc5760405162461bcd60e51b815260206004820152601d60248201527f4d757374206f66666572206174206c65617374206f6e6520736b696c6c00000060448201526064016104d8565b6040805160c08101825284815260208082018590528183018490526064606083015260016080830152600060a08301819052338152600490915291909120815181906111189082612fe7565b5060208281015180516111319260018501920190612672565b506040820151805161114d916002840191602090910190612672565b5060608201516003820155608082015160048201805460ff191691151591909117905560a09091015160059091015560405133907f69afed9d634a523326a5154a6052ccddf6d3e32f114440d70f57b1637504a252906111b2908690869086906130a7565b60405180910390a2505050565b6001600160a01b03811660009081526009602090815260409182902080548351818402810184019094528084526060939283018282801561121f57602002820191906000526020600020905b81548152602001906001019080831161120b575b50505050509050919050565b60008281526006602090815260408083208151610180810183528154815260018201549381019390935260028101546001600160a01b0390811692840192909252600381015490911660608301526004810180548694939291608084019161129290612f31565b80601f01602080910402602001604051908101604052809291908181526020018280546112be90612f31565b801561130b5780601f106112e05761010080835404028352916020019161130b565b820191906000526020600020905b8154815290600101906020018083116112ee5782900361f168201915b505050918352505060058281015460209092019160ff1690811115611332576113326128c2565b6005811115611343576113436128c2565b81526006820154602082015260078201546040820152600882015460ff80821615156060840152610100820416151560808301526201000090046001600160a01b031660a082015260098201805460c0909201916113a090612f31565b80601f01602080910402602001604051908101604052809291908181526020018280546113cc90612f31565b80156114195780601f106113ee57610100808354040283529160200191611419565b820191906000526020600020905b8154815290600101906020018083116113fc5782900361f168201915b5050505050815250509050336001600160a01b031681604001516001600160a01b03161480611454575060608101516001600160a01b031633145b61149b5760405162461bcd60e51b8152602060048201526018602482015277139bdd081c1c9bdc1bdcd85b081c185c9d1a58da5c185b9d60421b60448201526064016104d8565b6000848152600660205260409020600160058083015460ff16908111156114c4576114c46128c2565b146115095760405162461bcd60e51b8152602060048201526015602482015274141c9bdc1bdcd85b081b9bdd081858d8d95c1d1959605a1b60448201526064016104d8565b60088101546201000090046001600160a01b0316156115635760405162461bcd60e51b8152602060048201526016602482015275111a5cdc1d5d1948185b1c9958591e481c985a5cd95960521b60448201526064016104d8565b60058101805460ff1916600417905560088101805462010000330262010000600160b01b03199091161790556009810161159d8582612fe7565b50336001600160a01b0316857f1b84372106d77c6daea0dda35bbc0229d10a83f58ec899092884925193682341866040516115d891906130e0565b60405180910390a35050505050565b6000818152600a60205260408120546001600160a01b03166116425760405162461bcd60e51b8152602060048201526014602482015273151bdad95b88191bd95cc81b9bdd08195e1a5cdd60621b60448201526064016104d8565b506000908152600a60205260409020546001600160a01b031690565b6116996040518060c0016040528060608152602001606081526020016060815260200160008152602001600015158152602001600081525090565b6001600160a01b03821660009081526004602052604090819020815160c081019092528054829082906116cb90612f31565b80601f01602080910402602001604051908101604052809291908181526020018280546116f790612f31565b80156117445780601f1061171957610100808354040283529160200191611744565b820191906000526020600020905b8154815290600101906020018083116117275782900361f168201915b5050505050815260200160018201805480602002602001604051908101604052809291908181526020016000905b8282101561181e57838290600052602060002001805461179190612f31565b80601f01602080910402602001604051908101604052809291908181526020018280546117bd90612f31565b801561180a5780601f106117df5761010080835404028352916020019161180a565b820191906000526020600020905b8154815290600101906020018083116117ed5782900361f168201915b505050505081526020019060010190611772565b50505050815260200160028201805480602002602001604051908101604052809291908181526020016000905b828210156118f757838290600052602060002001805461186a90612f31565b80601f016020809104026020016040519081016040528092919081815260200182805461189690612f31565b80156118e35780601f10610e21576101008083540402835291602001916118e3565b820191906000526020600020905b8154815290600101906020018083116118c6578290361f168201915b50505050508152602001906001019061184b565b5050509082525060038201546020820152600482015460ff161515604082015260059091015460609091015292915050565b6001600160a01b03811660009081526008602090815260409182902080548351818402810184019094528084526060939283018282801561121f576020028201919060005260206000209081548152602001906001019080831161120b5750505050509050919050565b336000908152600460208190526040909120015460ff166119c65760405162461bcd60e51b81526004016104d890612f6b565b60008281526005602081905260409091200154829060ff16611a1f5760405162461bcd60e51b81526020600482015260126024820152714c697374696e67206e6f742061637469766560701b60448201526064016104d8565b600083815260056020526040902060010154336001600160a01b0390911603611a8a5760405162461bcd60e51b815260206004820152601d60248201527f43616e6e6f742070726f706f736520746f206f776e206c697374696e6700000060448201526064016104d8565b6000825111611adb5760405162461bcd60e51b815260206004820152601860248201527f50726f706f73616c2063616e6e6f7420626520656d707479000000000000000060448201526064016104d8565b60018054906000611aeb836130f3565b9091555050600180546040805161018081018252828152602080820188815233838501908152600060608501818152608086018b815260a087018390524260c088015260e087018390526101008701839052610120870183905261014087018390528751808701895283815261016088015288835260069095529590208451815591519682019690965594516002860180546001600160a01b03199081166001600160a01b039384161790915593516003870180549095169116179092559051919290916004820190611bbe9082612fe7565b5060a08201518160050160006101000a81548160ff02191690836005811115611be957611be96128c2565b021790555060c0820151600682015560e082015160078201556101008083015160088301805461012086015161014087015161ffff1990921693151561ff001916939093179215159093029190911762010000600160b01b031916620100006001600160a01b03909316929092029190911790556101608201516009820190611c729082612fe7565b50503360008181526008602090815260408083208054600181018255908452919092200184905551909150859083907fdbeeada8d13d404882ade3cd2d971481e3cf1c975c99899d5f54ba64a66bcee990611cce9088906130e0565b60405180910390a450505050565b60076020528160005260406000208181548110610a3757600080fd5b336000908152600460208190526040909120015460ff16611d2b5760405162461bcd60e51b815260206004820152601d60248201527f536b696c6c206f6666657265642063616e6e6f7420626520656d70747900000060448201526064016104d8565b6000825111611dcd5760405162461bcd60e51b815260206004820152601c60248201527f536b696c6c2077616e7465642063616e6e6f7420626520656d7074790000000060448201526064016104d8565b600080549080611ddc836130f3565b9091555050600080546040805160e0810182528281523360208083019182528284018981526060840189905260808401889052600160a085018190524260c086015286885260059092529390952082518155905194810180546001600160a01b0319166001600160a01b03909616959095179094559051919290916002820190611e669082612fe7565b5060608201516003820190611e7b9082612fe7565b5060808201516004820190611e909082612fe7565b5060a082015160058201805460ff191691151591909117905560c090910151600690910155336000818152600760209081526040808320805460018101825590845291909220018390555182907f2e71ed1e58f5f214ef80e9407079ff147132ea7ba2e55d4c2e41319be54e324590611f0e9088908890889061310c565b60405180910390a350505050565b60056020526000908152604090208054600182015460028301805492936001600160a01b0390921692611f4e90612f31565b80601f0160208091040260200160405190810160405280929190818152602001828054611f7a90612f31565b8015611fc75780601f10611f9c57610100808354040283529160200191611fc7565b820191906000526020600020905b815481529060010190602001808311611faa5782900361f168201915b505050505090806003018054611fdc90612f31565b80601f016020809104026020016040519081016040528092919081815260200182805461200890612f31565b80156120555780601f1061202a57610100808354040283529160200191612055565b820191906000526020600020905b8154815290600101906020018083116120385782900361f168201915b50505050509080600401805461206a90612f31565b80601f016020809104026020016040519081016040528092919081815260200182805461209690612f31565b80156120e35780601f106120b8576101008083540402835291602001916120e3565b820191906000526020600020905b8154815290600101906020018083116120c6578290361f168201915b505050506005830154600690930154919260ff1691905087565b60046020526000908152604090208054819061211890612f31565b80601f016020809104026020016040519081016040528092919081815260200182805461214490612f31565b80156121915780601f1061216657610100808354040283529160200191612191565b820191906000526020600020905b8154815290600101906020018083116117275782900361f168201915b50505050600383015460048401546005909401549293909260ff909116915084565b6122236040805161018081018252600080825260208201819052918101829052606080820183905260808201529060a08201908152602001600081526020016000815260200160001515815260200160001515815260200160006001600160a01b03168152602001606081525090565b6000828152600660209081526040918290208251610180810184528154815260018201549281019290925260028101546001600160a01b03908116938301939093526003810154909216606082015260048201805491929160808401919061228a90612f31565b80601f01602080910402602001604051908101604052809291908181526020018280546122b690612f31565b80156123035780601f106122d857610100808354040283529160200191612303565b820191906000526020600020905b8154815290600101906020018083116122e6578290361f168201915b505050918352505060058281015460209092019160ff169081111561232a5761232a6128c2565b600581111561233b5761233b6128c2565b81526006820154602082015260078201546040820152600882015460ff80821615156060840152610100820416151560808301526201000090046001600160a01b031660a082015260098201805460c09092019161239890612f31565b80601f01602080910402602001604051908101604052809291908181526020018280546123c490612f31565b80156124115780601f106123e657610100808354040283529160200191612411565b820191906000526020600020905b8154815290600101906020018083116123f4578290361f168201915b5050505050815250509050919050565b6001600160a01b03811660009081526007602090815260409182902080548351818402810184019094528084526060939283018282801561121f576020028201919060005260206000209081548152602001906001019080831161120b5750505050509050919050565b600081815260066020526040812060058101805460ff191660031790554260078201556002805491926124bd836130f3565b90915550506002805482820180546000838152600a6020908152604080832080546001600160a01b0319166001600160a01b0395861617905593549092168152600982529182208054600181018255908352908220018290558254919290612524836130f3565b9091555050600280546003840180546000838152600a6020908152604080832080546001600160a01b0319166001600160a01b0395861617905593548316825260098152838220805460018101825590835281832001859055948701549091168152600490935282206005018054919261259d836130f3565b909155505060038301546001600160a01b031660009081526004602052604081206005018054916125cd836130f3565b909155505060028301546001600160a01b03166000908152600460205260408120600301805460059290612602908490612f05565b90915550506003808401546001600160a01b03166000908152600460205260408120909101805460059290612638908490612f05565b90915550506040518190839086907f06fcd4e2b898ae87a5ad2d25ae9e47a773fdce32ecc1704bcce22e79f40538e790600090a450505050565b8280548282559060005260206000209081019282156126b8579160200282015b828111156126b857825182906126a89082612fe7565b5091602001919060010190612692565b506126c49291506126c8565b5090565b808211156126c45760006126dc82826126e5565b506001016126c8565b5080546126f190612f31565b6000825580601f10612701575050565b601f01602090049060005260206000209081019061271f9190612722565b50565b5b808211156126c45760008155600101612723565b80356001600160a01b038116811461274e57600080fd5b919050565b6000806040838503121561276657600080fd5b8235915061277660208401612737565b90509250929050565b60006020828403121561279157600080fd5b5035919050565b600080604083850312156127ab57600080fd5b6127b483612737565b946020939093013593505050565b6000815180845260005b818110156127e8576020818501810151868301820152016127cc565b506000602082860101526020601f19601f83011685010191505092915050565b602081528151602082015260018060a01b0360208301511660408201526000604083015160e060608401526128416101008401826127c2565b90506060840151601f198085840301608086015261285f83836127c2565b925060808601519150808584030160a08601525061287d82826127c2565b91505060a0840151151560c084015260c084015160e08401528091505092915050565b6000602082840312156128b257600080fd5b6128bb82612737565b9392505050565b634e487b7160e01b600052602160045260246000fd5b600681106128f657634e487b7160e01b600052602160045260246000fd5b9052565b8c8152602081018c90526001600160a01b038b811660408301528a166060820152610180608082018190526000906129348382018c6127c2565b905061294360a084018b6128d8565b8860c08401528760e08401528615156101008401528515156101208401526129776101408401866001600160a01b03169052565b82810361016084015261298a81856127c2565b9f9e505050505050505050505050505050565b634e487b7160e01b600052604160045260246000fd5b604051601f8201601f1916810167ffffffffffffffff811182821017156129dc576129dc61299d565b604052919050565b600082601f8301126129f557600080fd5b813567ffffffffffffffff811115612a0f57612a0f61299d565b612a22601f8201601f19166020016129b3565b818152846020838601011115612a3757600080fd5b816020850160208301376000918101602001919091529392505050565b600082601f830112612a6557600080fd5b8135602067ffffffffffffffff80831115612a8257612a8261299d565b8260051b612a918382016129b3565b9384528581018301938381019088861115612aab57600080fd5b84880192505b85831015612ae757823584811115612ac95760008081fd5b612ad78a87838c01016129e4565b8352509184019190840190612ab1565b98975050505050505050565b600080600060608486031215612b0857600080fd5b833567ffffffffffffffff80821115612b2057600080fd5b612b2c878388016129e4565b94506020860135915080821115612b4257600080fd5b612b4e87838801612a54565b93506040860135915080821115612b6457600080fd5b50612b7186828701612a54565b9150509250925092565b6020808252825182820181905260009190848201906040850190845b81811015612bb357835183529284019291840191600101612b97565b50909695505050505050565b60008060408385031215612bd257600080fd5b82359150602083013567ffffffffffffffff811115612bf057600080fd5b612bfc858286016129e4565b9150509250929050565b600081518084526020808501808196508360051b8101915082860160005b85811015612c4e578284038952612c3c8483516127c2565b98850198935090840190600101612c24565b5091979650505050505050565b602081526000825160c06020840152612c7760e08401826127c2565b90506020840151601f1980858403016040860152612c958383612c06565b9250604086015191508085840301606086015250612cb38282612c06565b915050606084015160808401526080840151151560a084015260a084015160c08401528091505092915050565b600080600060608486031215612cf557600080fd5b833567ffffffffffffffff80821115612d0d57600080fd5b612d19878388016129e4565b94506020860135915080821115612d2f57600080fd5b612d3b878388016129e4565b93506040860135915080821115612d5157600080fd5b50612b71868287016129e4565b8781526001600160a01b038716602082015260e060408201819052600090612d88908301886127c2565b8281036060840152612d9a81886127c2565b90508281036080840152612dae81876127c2565b94151560a0840152505060c0015295945050505050565b608081526000612dd860808301876127c2565b6020830195909552509115156040830152606090910152919050565b60208152815160208201526020820151604082015260006040830151612e2560608401826001600160a01b03169052565b5060608301516001600160a01b03811660808401525060808301516101808060a0850152612e576101a08501836127c2565b915060a0850151612e6b60c08601826128d8565b5060c085015160e085015260e0850151610100818187015280870151915050610120612e9a8187018315159052565b8601519050610140612eaf8682018315159052565b8601519050610160612ecb868201836001600160a01b03169052565b860151858403601f1901838701529050612ee583826127c2565b9695505050505050565b634e487b7160e01b600052601160045260246000fd5b80820180821115612f1857612f18612eef565b92915050565b81810381811115612f1857612f18612eef565b600181811c90821680612f4557607f821691505b602082108103612f6557634e487b7160e01b600052602260045260246000fd5b50919050565b602080825260139082015272155cd95c881b9bdd081c9959da5cdd195c9959606a1b604082015260600190565b601f821115612fe257600081815260208120601f850160051c81016020861015612fbf5750805b601f850160051c820191505b81811015612fde57828155600101612fcb565b5050505b505050565b815167ffffffffffffffff8111156130015761300161299d565b6130158161300f8454612f31565b84612f98565b602080601f83116001811461304a57600084156130325750858301515b600019600386901b1c1916600185901b178555612fde565b600085815260208120601f198616915b828110156130795788860151825594840194600190910190840161305a565b50858210156130975787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b6060815260006130ba60608301866127c2565b82810360208401526130cc8186612c06565b90508281036040840152612ee58185612c06565b6020815260006128bb60208301846127c2565b60006001820161310557613105612eef565b5060010190565b60608152600061311f60608301866127c2565b828103602084015261313181866127c2565b90508281036040840152612ee581856127c256fea264697066735822122025856e64288562bc3cd69c1f3918c26137f63660f751141f1968a3cfcc8934b064736f6c63430008130033';
        
        console.log('üì¶ Contract bytecode prepared');
        
        // Create contract deployment transaction
        console.log('üìù Creating contract deployment transaction...');
        
        const contractCreateFlow = new ContractCreateFlow()
            .setBytecode(contractBytecode)
            .setGas(5000000)
            .setAdminKey(operatorKey.publicKey);
        
        console.log('‚è≥ Executing deployment transaction...');
        
        // Execute the deployment
        const contractCreateResponse = await contractCreateFlow.execute(client);
        const contractCreateReceipt = await contractCreateResponse.getReceipt(client);
        const contractId = contractCreateReceipt.contractId;
        
        console.log('\nüéâ Contract deployed successfully!');
        console.log(`üìÑ Contract ID: ${contractId.toString()}`);
        console.log(`üåê Network: testnet`);
        console.log(`üîó Explorer: https://hashscan.io/testnet/contract/${contractId.toString()}`);
        console.log(`üìä Transaction ID: ${contractCreateReceipt.transactionId.toString()}`);
        
        // Save deployment info
        const deploymentInfo = {
            contractId: contractId.toString(),
            network: 'testnet',
            accountId: accountId,
            timestamp: new Date().toISOString(),
            explorer: `https://hashscan.io/testnet/contract/${contractId.toString()}`,
            contractName: 'SkillSwap',
            contractSymbol: 'SKILL',
            version: '1.0.0',
            transactionId: contractCreateReceipt.transactionId.toString()
        };
        
        const filename = `deployment-testnet-${Date.now()}.json`;
        fs.writeFileSync(filename, JSON.stringify(deploymentInfo, null, 2));
        
        console.log(`üíæ Deployment info saved to: ${filename}`);
        
        console.log('\nüß™ Next steps:');
        console.log('1. Test your contract: node test-contract.js ' + contractId.toString() + ' testnet');
        console.log('2. View on HashScan: https://hashscan.io/testnet/contract/' + contractId.toString());
        console.log('3. Build your frontend to interact with the contract');
        
        return contractId;
        
    } catch (error) {
        console.error('üí• Deployment failed:', error.message);
        console.error('Stack trace:', error.stack);
        process.exit(1);
    }
}

// Run deployment
if (require.main === module) {
    deploySkillSwap();
}

module.exports = { deploySkillSwap };
